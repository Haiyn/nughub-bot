<!DOCTYPE html><html class="default no-js"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>nughub-bot</title><meta name="description" content="Documentation for nughub-bot"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">nughub-bot</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> nughub-bot</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#nughub-bot" id="nughub-bot" style="color: inherit; text-decoration: none;">
  <h1>nughub-bot</h1>
</a>
<blockquote>
<p>A Discord.js bot for The Nug Hub.</p>
</blockquote>

<a href="#infrastructure" id="infrastructure" style="color: inherit; text-decoration: none;">
  <h2>Infrastructure</h2>
</a>
<p>t.b.a.</p>

<a href="#architecture" id="architecture" style="color: inherit; text-decoration: none;">
  <h2>Architecture</h2>
</a>
<p>t.b.a.</p>

<a href="#naming-conventions" id="naming-conventions" style="color: inherit; text-decoration: none;">
  <h3>Naming Conventions</h3>
</a>
<p>String and Emoji values in the database are in UPPER-KEBAB-CASE with dots (<code>.</code>) separating 
the categories. They are prefixed by a <code>STRINGS</code> or <code>EMOJIS</code> key prefix respectively:</p>
<pre><code><span class="hl-0">// String</span><br/><span class="hl-1">STRINGS</span><span class="hl-2">.</span><span class="hl-1">CATEGORY</span><span class="hl-2">.</span><span class="hl-1">ANOTHER</span><span class="hl-2">-</span><span class="hl-1">CATEGORY</span><span class="hl-2">.</span><span class="hl-1">LAST</span><span class="hl-2">-</span><span class="hl-1">CATEGORY</span><br/><br/><span class="hl-0">// Emoji</span><br/><span class="hl-1">EMOJIS</span><span class="hl-2">.</span><span class="hl-1">CATEGORY</span><span class="hl-2">.</span><span class="hl-1">ANOTHER</span><span class="hl-2">-</span><span class="hl-1">CATEGORY</span><span class="hl-2">.</span><span class="hl-1">LAST</span><span class="hl-2">-</span><span class="hl-1">CATEGORY</span>
</code></pre>
<p>Configuration values are in Pascal_CamelCase. They are prefixed by a <code>CONFIGURATION_</code> key prefix:</p>
<pre><code><span class="hl-3">CONFIGURATION_SomeCategory_SomeConfigurationValue</span>
</code></pre>

<a href="#development-setup" id="development-setup" style="color: inherit; text-decoration: none;">
  <h2>Development Setup</h2>
</a>
<p><img src="https://img.shields.io/badge/node--lts-v16.6.0-blue?style=flat&logo=nodedotjs" alt="node-shield">
<img src="https://img.shields.io/badge/docker-v20.10.5-blue?style=flat&logo=docker" alt="docker-shield">
<img src="https://img.shields.io/badge/docker--compose-v1.28.6-blue?style=flat&logo=docker" alt="docker-compose-shield">
<img src="https://img.shields.io/badge/MongoDB--Compass-v1.28.4-blue?style=flat&logo=mongodb" alt="mongodb-compass-shield"></p>
<!-- Image Definitions -->

<a href="#setting-up-the-base-layer" id="setting-up-the-base-layer" style="color: inherit; text-decoration: none;">
  <h3>Setting up the base layer</h3>
</a>
<ol>
<li>Create an <code>.env</code> file in the root of the project with the following values:</li>
</ol>
<pre><code class="language-dotenv"># ORCHESTRATION
BOT_VERSION=[SemVer]
ENVIRONMENT=local

# SECRETS
TOKEN=[THE_BOT_TOKEN]
CLIENT_ID=[THE_BOT_CLIENT_ID]

# MONGODB
MONGODB_CONNSTR=mongodb://nhb-user:dev-user@localhost:27017/nhb?authSource=admin
MONGODB_ROOT_USER=nhb-admin
MONGODB_ROOT_PASS=dev-admin
MONGODB_ROOT_NAME=admin
MONGODB_USER=nhb-user
MONGODB_PASS=dev-user
MONGODB_NAME=nhb

# REDIS
REDIS_CONNSTR=redis://default:dev@localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASS=dev

# CONFIGURATION
BOT_OWNER_ID=[YOUR_DISCORD_ID]
GUILD_ID=[GUILD_ID_WHERE_BOT_SHOULD_WORK]

# LOGGING
BASE_LOG_LEVEL=trace
SERVICE_LOG_LEVEL=trace
COMMAND_LOG_LEVEL=trace
PROVIDER_LOG_LEVEL=trace
IGNORE_STACK_LEVELS=6
</code></pre>

<a href="#setting-up-the-application-layer" id="setting-up-the-application-layer" style="color: inherit; text-decoration: none;">
  <h3>Setting up the application layer</h3>
</a>
<ol>
<li>Install npm dependencies</li>
</ol>
<pre><code class="language-shell"><span class="hl-2">npm install</span>
</code></pre>
<ol start="2">
<li>Run the bot</li>
</ol>
<pre><code class="language-shell"><span class="hl-2">npm run start</span>
</code></pre>
<p>With Live Reload:</p>
<pre><code class="language-shell"><span class="hl-2">npm run watch</span>
</code></pre>

<a href="#setting-up-the-data-layer" id="setting-up-the-data-layer" style="color: inherit; text-decoration: none;">
  <h3>Setting up the data layer</h3>
</a>
<ol>
<li>Run the databases</li>
</ol>
<pre><code class="language-shell"><span class="hl-2">docker-compose up -d nhb-mongodb nhb-redis</span>
</code></pre>
<p>The MongoDB will be started with the authentication database <code>admin</code> that will contain the user <code>nhb-user</code> with the 
password <code>dev-user</code> (specified in the dotenv file). The user has read and write permissions on the <code>nhb</code> database (also 
specified in dotenv file).</p>
<ol start="2">
<li>Run RedisInsight</li>
</ol>
<pre><code class="language-shell"><span class="hl-2">docker run -v redisinsight:/db -p 8001:8001 redislabs/redisinsight:latest</span>
</code></pre>
<p>The redis database will be created with one default user, and the password specified in the dotenv file.</p>
<ol start="3">
<li>Connect to Redis database via RedisInsight</li>
</ol>
<p>Open <code>localhost:8001</code> and connect to existing database with these values:</p>
<ul>
<li><strong>Host:</strong> Host-IP (<code>ifconfig -a</code>)</li>
<li><strong>Port:</strong> 6379</li>
<li><strong>Name:</strong> nhb-redis</li>
<li><strong>Username:</strong> default</li>
<li><strong>Password:</strong> Value from <code>.env</code> file</li>
</ul>
<ol start="4">
<li>Connect to MongoDB via MongoDB Compass</li>
</ol>
<p>Enter the connection string from the dotenv file and connect.</p>

<a href="#data-management" id="data-management" style="color: inherit; text-decoration: none;">
  <h2>Data Management</h2>
</a>

<a href="#managing-strings" id="managing-strings" style="color: inherit; text-decoration: none;">
  <h3>Managing Strings</h3>
</a>
<p>To manage strings, either add them manually in RedisInsight or use the script in <code>orchestration/redis/import-strings.sh</code>. 
The script needs a CSV file with a <code>;</code> delimiter to work. </p>
<p>The script will only work on the local machine.</p>
<p>The best way to achieve data consistence is to either export it with that delimiter or use a <code>tsv</code> file and replace all tab characters with semicolons.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/commands.html">commands</a></li><li class=" tsd-kind-module"><a href="modules/commands_definitions.html">commands/definitions</a></li><li class=" tsd-kind-module"><a href="modules/controllers.html">controllers</a></li><li class=" tsd-kind-module"><a href="modules/models.html">models</a></li><li class=" tsd-kind-module"><a href="modules/providers.html">providers</a></li><li class=" tsd-kind-module"><a href="modules/server.html">server</a></li><li class=" tsd-kind-module"><a href="modules/services.html">services</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>